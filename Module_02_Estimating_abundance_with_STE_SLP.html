<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Read Barbee" />

<meta name="date" content="2024-08-17" />

<title>Module 02: Estimating abundance with STE</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Module 02: Estimating abundance with
STE</h1>
<h4 class="author">Read Barbee</h4>
<h4 class="date">2024-08-17</h4>



<div id="attribution" class="section level2">
<h2>Attribution</h2>
<p>This walkthrough is adapted from the vignette “using spaceNtime”
(Moeller and Lukacs 2021)</p>
<p>When using the spaceNtime package, please cite <a href="https://link.springer.com/content/pdf/10.1007/s42991-021-00181-8.pdf">Moeller
and Lukacs 2021</a></p>
</div>
<div id="purpose" class="section level2">
<h2>Purpose</h2>
<p>In this module, we will discuss the input data and data structures
required to run Space to Event (STE) models using the spaceNtime package
in R. By the end of this module, you should understand what data
structures are required for STE models and how to prepare the input
files.</p>
</div>
<div id="background-what-kind-of-data-do-we-need-for-ste" class="section level2">
<h2>Background: What kind of data do we need for STE?</h2>
<p>Recall that, unlike Time to Event (TTE) and Instantaneous Sampling
(IS) models, Space to Event (STE) models require TIIMELAPSE data. This
means that all cameras are programmed to take photos at regular
intervals regardless of whether or not an animal is present.</p>
<p>To run a Space to Event (STE) model, we will need two separate data
files:</p>
<div id="photo-information" class="section level3">
<h3>1. Photo information</h3>
<p>The first, called “df”, is a data frame or tibble with one row for
each time lapse photo from each station.</p>
<p>This must contain, at a minimum, these three columns (names and
classes must match exactly):</p>
<ul>
<li><p><strong>cam</strong>: The unique ID of the sampling site (any
class)</p></li>
<li><p><strong>datetime</strong>: The date and time of the photo (class
POSIXct)</p></li>
<li><p><strong>count</strong>: The count of your study species at each
date and time. For STE and TTE, this can be simply species presence or
absence (0 or 1) (class numeric)</p></li>
</ul>
<table>
<caption>df</caption>
<thead>
<tr class="header">
<th align="right">cam</th>
<th align="left">datetime</th>
<th align="right">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">2016-01-02 12:00:00</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">2016-01-03 13:12:00</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">2016-01-02 12:00:00</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">2016-01-02 14:00:00</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">2016-01-03 16:53:42</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
</div>
<div id="camera-deployment-information" class="section level3">
<h3>2. Camera deployment information</h3>
<p>The second, called “deploy”, is a data frame or tibble that contains
information about the active periods for each active camera and their
areas. <strong>Please note,</strong> to get accurate estimates, this
should include all cameras that were functioning, not just the ones that
got pictures of your target species.</p>
<p>There are two ways to format this dataframe: the “Motion Sensor
Format” and the “Timelapse Format”. Either one can be used for STE
timelapse data, but the Timelapse Format is better because any missing
photos are interpreted as camera malfunctions rather than counts of 0
animals. Furthermore, this allows more flexibility for users when
recording information about camera area and functionality at each
timestep. For example, a photo with the lens covered in snow could be
coded as area = 0. We will explore both versions in this
walkthrough.</p>
<div id="the-motion-sensor-format" class="section level4">
<h4>The Motion Sensor Format</h4>
<p>In this format, each row represents a period of continuous
functionality for a camera. If a camera ever went offline then came back
on, it should have multiple rows. For cameras with multiple entries, the
time periods should never overlap. Whenever the camera’s area changes,
it should be entered as a new row. Setting area = 0 is equivalent to the
camera not functioning. If a camera has any missing periods, it will be
assumed that the camera was not working during that time.</p>
<p>It will have the following columns, at a minimum:</p>
<ul>
<li><p><strong>cam</strong>: The unique ID of the sampling site (same
class as df$cam)</p></li>
<li><p><strong>start</strong>: The date and time of the start of
continuous camera functioning (same class and tz as
df$datetime)</p></li>
<li><p><strong>end</strong>: The date and time of the end of continuous
camera functioning (same class and tz as df$datetime)</p></li>
<li><p><strong>area</strong>: the camera’s visible area, in any units
(class numeric)</p></li>
</ul>
<p><strong>Note</strong>: While “area” can be in any units, I find it
most intuitive to use m2, as it is easier to visualize than km2 for
camera areas.</p>
<table>
<caption>deploy: The Motion Sensor Format</caption>
<thead>
<tr class="header">
<th align="right">cam</th>
<th align="left">start</th>
<th align="left">end</th>
<th align="right">area</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">2015-12-01 15:00:00</td>
<td align="left">2016-01-05 00:00:00</td>
<td align="right">300</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">2015-12-08 00:00:00</td>
<td align="left">2015-12-19 03:30:00</td>
<td align="right">200</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">2016-01-01 00:00:00</td>
<td align="left">2016-01-01 05:00:00</td>
<td align="right">200</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">2016-01-02 00:00:00</td>
<td align="left">2016-01-05 00:00:00</td>
<td align="right">450</td>
</tr>
</tbody>
</table>
</div>
<div id="the-timelapse-format" class="section level4">
<h4>The Timelapse Format</h4>
<p>As with df, this data frame will have one row for each time lapse
photo from each station. The difference is that it will have a column
for the camera area for each photo instead of the target species count.
It will have the following columns, at a minimum:</p>
<ul>
<li><p><strong>cam</strong>: The unique ID of the sampling site (same
class as df$cam)</p></li>
<li><p><strong>start</strong>: The date and time of the photo (same
class and tz as df$datetime)</p></li>
<li><p><strong>end</strong>: The date and time of the photo (same class
and tz as df$datetime)</p></li>
<li><p><strong>area</strong>: the camera’s visible area, in any units
(class numeric)</p></li>
</ul>
<p>The area should be 0 on any occasion that the camera was obstructed
or malfunctioning. In most cases, the end date_time will be the same as
the start date_time.</p>
<p>Because the format is the same as the df object except for one
column, we have the option of creating the deploy object directly from
the df object.</p>
<table>
<caption>deploy: The Timelapse Format</caption>
<thead>
<tr class="header">
<th align="right">cam</th>
<th align="left">start</th>
<th align="left">end</th>
<th align="right">area</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">2016-01-02 12:00:00</td>
<td align="left">2016-01-02 12:00:00</td>
<td align="right">300</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">2016-01-02 14:00:00</td>
<td align="left">2016-01-02 14:00:00</td>
<td align="right">300</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">2016-01-02 12:00:00</td>
<td align="left">2016-01-02 12:00:00</td>
<td align="right">200</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">2016-01-02 14:00:00</td>
<td align="left">2016-01-02 14:00:00</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">2016-01-03 16:00:00</td>
<td align="left">2016-01-03 16:00:00</td>
<td align="right">450</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="preparing-the-data" class="section level2">
<h2>Preparing the data</h2>
<p>Now we’re ready to get started! We’ll be using example data from SLP.
The dataset contains many prey species, but we will focus on the wild
boar for this analysis since it is the most frequently detected
species.</p>
</div>
<div id="version-1-motion-triggered-data" class="section level2">
<h2>Version 1: Motion-Triggered Data</h2>
<p>STE models are designed to be run on time-lapse photo data, but they
can also be used with motion-trigger data. We will start with the
motion-triggered version since our data is already in that format. Then
we will repeat the analyis with a new “timelapse” version of the
dataset.</p>
</div>
<div id="step-1-load-the-required-packages" class="section level2">
<h2>Step 1: Load the required packages</h2>
<p>If you haven’t already installed the spaceNtime package, please go
back to Module 01: Installing spaceNtime.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(spaceNtime)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
</div>
<div id="step-2-import-the-example-data" class="section level2">
<h2>Step 2: Import the example data</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co">#classified photos</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>count_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;SCL/SLP/2022_SLP_Master_All_records_IDS_S3018_20221108_20230219.csv&quot;</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#camera deployment dates and visible areas</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>cam_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;SCL/SLP/SLP_2022_CameraDetails.csv&quot;</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span></code></pre></div>
<p>Let’s examine the example data to see what we’re working with:</p>
<table>
<caption>Example Data</caption>
<colgroup>
<col width="16%" />
<col width="4%" />
<col width="23%" />
<col width="2%" />
<col width="2%" />
<col width="3%" />
<col width="3%" />
<col width="7%" />
<col width="7%" />
<col width="2%" />
<col width="8%" />
<col width="5%" />
<col width="2%" />
<col width="4%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">trigger_id</th>
<th align="right">image_number</th>
<th align="left">file_name_new</th>
<th align="left">station</th>
<th align="left">cameras</th>
<th align="right">x</th>
<th align="right">y</th>
<th align="left">date_time_original</th>
<th align="left">date_time_original2</th>
<th align="right">group</th>
<th align="left">survey_id</th>
<th align="left">species</th>
<th align="right">number</th>
<th align="right">capture_event</th>
<th align="right">trigger_per_event</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">S3018_20221108_20230219__AY39_a__CA702432__7</td>
<td align="right">1</td>
<td align="left">S3018__AY39_a__Camera1__CA702432__2022-11-29__05-01-24__7__1.JPG</td>
<td align="left">AY39_a</td>
<td align="left">Camera1</td>
<td align="right">99.24616</td>
<td align="right">14.65108</td>
<td align="left">2022-11-28 22:01:24</td>
<td align="left">11/29/2022 5:01</td>
<td align="right">1</td>
<td align="left">S3018_20221108_20230219</td>
<td align="left">Bat_Unspecified</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">S3018_20221108_20230219__AY39_a__CA702432__6</td>
<td align="right">1</td>
<td align="left">S3018__AY39_a__Camera1__CA702432__2022-11-29__02-32-06__6__1.JPG</td>
<td align="left">AY39_a</td>
<td align="left">Camera1</td>
<td align="right">99.24616</td>
<td align="right">14.65108</td>
<td align="left">2022-11-28 19:32:06</td>
<td align="left">11/29/2022 2:32</td>
<td align="right">1</td>
<td align="left">S3018_20221108_20230219</td>
<td align="left">Blank</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">S3018_20221108_20230219__AY39_a__CA702432__8</td>
<td align="right">1</td>
<td align="left">S3018__AY39_a__Camera1__CA702432__2022-11-30__00-05-08__8__1.JPG</td>
<td align="left">AY39_a</td>
<td align="left">Camera1</td>
<td align="right">99.24616</td>
<td align="right">14.65108</td>
<td align="left">2022-11-29 17:05:08</td>
<td align="left">11/30/2022 0:05</td>
<td align="right">1</td>
<td align="left">S3018_20221108_20230219</td>
<td align="left">Blank</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">S3018_20221108_20230219__AY39_a__CA702432__9</td>
<td align="right">1</td>
<td align="left">S3018__AY39_a__Camera1__CA702432__2022-11-30__13-50-54__9__1.JPG</td>
<td align="left">AY39_a</td>
<td align="left">Camera1</td>
<td align="right">99.24616</td>
<td align="right">14.65108</td>
<td align="left">2022-11-30 06:50:54</td>
<td align="left">11/30/2022 13:50</td>
<td align="right">1</td>
<td align="left">S3018_20221108_20230219</td>
<td align="left">Blank</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">S3018_20221108_20230219__AY39_a__CA702432__10</td>
<td align="right">1</td>
<td align="left">S3018__AY39_a__Camera1__CA702432__2022-11-30__13-50-59__10__1.JPG</td>
<td align="left">AY39_a</td>
<td align="left">Camera1</td>
<td align="right">99.24616</td>
<td align="right">14.65108</td>
<td align="left">2022-11-30 06:50:59</td>
<td align="left">11/30/2022 13:50</td>
<td align="right">1</td>
<td align="left">S3018_20221108_20230219</td>
<td align="left">Blank</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="left">S3018_20221108_20230219__AY39_a__CA702432__11</td>
<td align="right">1</td>
<td align="left">S3018__AY39_a__Camera1__CA702432__2022-11-30__13-51-03__11__1.JPG</td>
<td align="left">AY39_a</td>
<td align="left">Camera1</td>
<td align="right">99.24616</td>
<td align="right">14.65108</td>
<td align="left">2022-11-30 06:51:03</td>
<td align="left">11/30/2022 13:51</td>
<td align="right">1</td>
<td align="left">S3018_20221108_20230219</td>
<td align="left">Blank</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">range</span>(count_data<span class="sc">$</span>date_time_original)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt; [1] &quot;2022-11-08 03:42:04 UTC&quot; &quot;2023-02-19 00:19:24 UTC&quot;</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="fu">distinct</span>(count_data, station)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; # A tibble: 67 × 1</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt;    station</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;  </span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt;  1 AY39_a </span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt;  2 AZ38_a </span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt;  3 AZ39_c </span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt;  4 AZ40_b </span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt;  5 BA38_c </span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt;  6 BA39_b </span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#&gt;  7 BA40_b </span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#&gt;  8 BA41_b </span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#&gt;  9 BA42_a </span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#&gt; 10 BA43_b </span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="co">#&gt; # ℹ 57 more rows</span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="fu">distinct</span>(count_data, species)</span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="co">#&gt; # A tibble: 55 × 1</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="co">#&gt;    species             </span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a><span class="co">#&gt;    &lt;chr&gt;               </span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="co">#&gt;  1 Bat_Unspecified     </span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a><span class="co">#&gt;  2 Blank               </span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a><span class="co">#&gt;  3 Cat_Leopard         </span></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a><span class="co">#&gt;  4 Human_Field_Team    </span></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a><span class="co">#&gt;  5 Macaque_Pig_Tailed  </span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a><span class="co">#&gt;  6 Muntjac_Feas        </span></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a><span class="co">#&gt;  7 Muntjac_Northern_Red</span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a><span class="co">#&gt;  8 Serow_Mainland      </span></span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a><span class="co">#&gt;  9 Boar_Wild           </span></span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a><span class="co">#&gt; 10 Civet_Large_Indian  </span></span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a><span class="co">#&gt; # ℹ 45 more rows</span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a></span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a><span class="fu">distinct</span>(count_data, group)</span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a><span class="co">#&gt; # A tibble: 3 × 1</span></span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a><span class="co">#&gt;   group</span></span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a><span class="co">#&gt; 1     1</span></span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a><span class="co">#&gt; 2    NA</span></span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a><span class="co">#&gt; 3     2</span></span></code></pre></div>
<p>STE can only estimate abundance for one species at a time. We will
use wild boar for this example since they are one of the most frequently
detected. We will create a new column for the count of boar in each
photo. All photos of other species will recieve a count of 0. After that
we no longer need the species or group size columns, so we can remove
them. We can also remove the study column because it is the same for all
the data.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>boar_data <span class="ot">&lt;-</span> count_data <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="fu">distinct</span>(station, species, date_time_original, <span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span> <span class="co">#remove duplicate rows</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">boar =</span> <span class="fu">case_when</span>(species <span class="sc">==</span> <span class="st">&quot;Boar_Wild&quot;</span> <span class="sc">~</span> group, <span class="co">#make new column. Fill non-target species with 0s</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>                          species <span class="sc">!=</span> <span class="st">&quot;Boar_Wild&quot;</span> <span class="sc">~</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="fu">select</span>(station, date_time_original, boar) <span class="co">#subset the necessary columns</span></span></code></pre></div>
<p>So we are left with 3 columns:</p>
<ul>
<li><p><strong>station</strong>: the name of the camera station. There
appear to be 11 distinct stations (class: character)</p></li>
<li><p><strong>date_time</strong>: the time stamp for each photo in the
timelapse for each station. Note that the timezone is “UTC” by default.
It is generally recommended to work in UTC to avoid errors due to
timezone conversion. (class: dttm)</p></li>
<li><p><strong>boar</strong>: the number of individuals of the target
species detected in each photo. In this case, our values range from 0 to
1. For STE and TTE, the count doesn’t really matter. We just need to
know if the species was detected or not (1 or 0). (class:
double)</p></li>
</ul>
</div>
<div id="step-3-create-the-photo-information-data-frame" class="section level2">
<h2>Step 3: Create the photo information data frame</h2>
<p>Recall that for the “df” object, we only need columns for the camera
station, time stamp, and the count of target animals, and they need to
be named “cam”, “datetime”, and “count” respectively. Let’s create that
object now by subsetting the required columns from our example data and
renaming them:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> boar_data <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="fu">select</span>(station, date_time_original, boar) <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">cam =</span> station,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>         <span class="at">datetime =</span> date_time_original,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>         <span class="at">count =</span> boar)</span></code></pre></div>
<table>
<caption>df</caption>
<thead>
<tr class="header">
<th align="left">cam</th>
<th align="left">datetime</th>
<th align="right">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AY39_a</td>
<td align="left">2022-11-28 22:01:24</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">AY39_a</td>
<td align="left">2022-11-28 19:32:06</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">AY39_a</td>
<td align="left">2022-11-29 17:05:08</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">AY39_a</td>
<td align="left">2022-11-30 06:50:54</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">AY39_a</td>
<td align="left">2022-11-30 06:50:59</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">AY39_a</td>
<td align="left">2022-11-30 06:51:03</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>That’s all there is to it! On to the next step.</p>
</div>
<div id="step-4-create-the-deployment-data-frame" class="section level2">
<h2>Step 4: Create the deployment data frame</h2>
<p>Now we need to create our “deploy” object in the “Motion Sensor
Format”. Let’s start by looking at the data we have for our camera
deployments:</p>
<table style="width:100%;">
<caption>cam_data</caption>
<colgroup>
<col width="12%" />
<col width="13%" />
<col width="4%" />
<col width="7%" />
<col width="7%" />
<col width="14%" />
<col width="21%" />
<col width="9%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">survey_effort</th>
<th align="left">camera_station</th>
<th align="left">p_as</th>
<th align="right">x_coord</th>
<th align="right">y_coord</th>
<th align="left">deployment_date</th>
<th align="left">last_active_day_station</th>
<th align="right">area_km2_1</th>
<th align="right">area_km2_2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2022_SLP</td>
<td align="left">AY39_a</td>
<td align="left">SLP</td>
<td align="right">526506</td>
<td align="right">1619749</td>
<td align="left">11/22/2022</td>
<td align="left">1/25/2023</td>
<td align="right">1.54e-05</td>
<td align="right">2.04e-05</td>
</tr>
<tr class="even">
<td align="left">2022_SLP</td>
<td align="left">AZ38_a</td>
<td align="left">SLP</td>
<td align="right">521702</td>
<td align="right">1617099</td>
<td align="left">11/28/2022</td>
<td align="left">2/3/2023</td>
<td align="right">1.54e-05</td>
<td align="right">2.04e-05</td>
</tr>
<tr class="odd">
<td align="left">2022_SLP</td>
<td align="left">AZ39_c</td>
<td align="left">SLP</td>
<td align="right">525464</td>
<td align="right">1616844</td>
<td align="left">11/23/2022</td>
<td align="left">1/9/2023</td>
<td align="right">1.54e-05</td>
<td align="right">2.04e-05</td>
</tr>
<tr class="even">
<td align="left">2022_SLP</td>
<td align="left">AZ40_b</td>
<td align="left">SLP</td>
<td align="right">528674</td>
<td align="right">1618825</td>
<td align="left">11/21/2022</td>
<td align="left">1/20/2023</td>
<td align="right">1.54e-05</td>
<td align="right">2.04e-05</td>
</tr>
<tr class="odd">
<td align="left">2022_SLP</td>
<td align="left">BA38_c</td>
<td align="left">SLP</td>
<td align="right">522188</td>
<td align="right">1615059</td>
<td align="left">11/23/2022</td>
<td align="left">1/23/2023</td>
<td align="right">1.54e-05</td>
<td align="right">2.04e-05</td>
</tr>
<tr class="even">
<td align="left">2022_SLP</td>
<td align="left">BA39_b</td>
<td align="left">SLP</td>
<td align="right">524030</td>
<td align="right">1614699</td>
<td align="left">11/23/2022</td>
<td align="left">1/28/2023</td>
<td align="right">1.54e-05</td>
<td align="right">2.04e-05</td>
</tr>
</tbody>
</table>
<p>Here we have columns for station names, locations, deployment dates,
and viewable area in km2. We only need station, start date, end date,
and area, so lets subset and rename those here. Note that it is very
important to record time stamps in addition to dates whenever possible.
Because we don’t know the exact start and end times for this dataset, we
will set the times at 00:00:00 for each date. We will also convert the
area from km2 to m2, because that is easier to visualize:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>deploy <span class="ot">&lt;-</span> cam_data <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="fu">select</span>(camera_station, deployment_date, last_active_day_station, area_km2_1) <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">deployment_date =</span> <span class="fu">mdy_hms</span>(<span class="fu">paste</span>(<span class="fu">as.character</span>(deployment_date), <span class="st">&quot;00:00:00&quot;</span>)), <span class="co">#add timestamps</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>         <span class="at">last_active_day_station =</span> <span class="fu">mdy_hms</span>(<span class="fu">paste</span>(<span class="fu">as.character</span>(last_active_day_station), <span class="st">&quot;00:00:00&quot;</span>)),</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>         <span class="at">area_km2_1 =</span> area_km2_1 <span class="sc">*</span> <span class="fl">1e6</span>) <span class="sc">%&gt;%</span> <span class="co">#convert area from km2 to m2</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">cam =</span> camera_station,</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>         <span class="at">start =</span> deployment_date,</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>         <span class="at">end =</span> last_active_day_station,</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>         <span class="at">area =</span> area_km2_1)</span></code></pre></div>
<table>
<caption>deploy</caption>
<thead>
<tr class="header">
<th align="left">cam</th>
<th align="left">start</th>
<th align="left">end</th>
<th align="right">area</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AY39_a</td>
<td align="left">2022-11-22</td>
<td align="left">2023-01-25</td>
<td align="right">15.4</td>
</tr>
<tr class="even">
<td align="left">AZ38_a</td>
<td align="left">2022-11-28</td>
<td align="left">2023-02-03</td>
<td align="right">15.4</td>
</tr>
<tr class="odd">
<td align="left">AZ39_c</td>
<td align="left">2022-11-23</td>
<td align="left">2023-01-09</td>
<td align="right">15.4</td>
</tr>
<tr class="even">
<td align="left">AZ40_b</td>
<td align="left">2022-11-21</td>
<td align="left">2023-01-20</td>
<td align="right">15.4</td>
</tr>
<tr class="odd">
<td align="left">BA38_c</td>
<td align="left">2022-11-23</td>
<td align="left">2023-01-23</td>
<td align="right">15.4</td>
</tr>
<tr class="even">
<td align="left">BA39_b</td>
<td align="left">2022-11-23</td>
<td align="left">2023-01-28</td>
<td align="right">15.4</td>
</tr>
</tbody>
</table>
</div>
<div id="step-5-specify-the-sampling-occasions" class="section level2">
<h2>Step 5: Specify the sampling occasions</h2>
<p>Next we need to define our sampling occasions. Each row in this
dataframe represents a unit of time in which we assume that all cameras
were sampling their areas simultaneously. We can build this object
manually or with the function build_occ(). For the latter, we need to
define the following:</p>
<p>-<strong>study_dates</strong>: the start and end dates of our
study</p>
<p>-<strong>samp_freq</strong>: the amount of time (in seconds) between
the start of one sampling occasion and the next.</p>
<p>-<strong>samp_length</strong>: the duration of each sampling occasion
(in seconds). This represents how much time each camera had to take a
photo within the sampling occasion.</p>
<p>For the sake of this example, we’ll define the sampling frequency as
<strong>3600 seconds (1 hour)</strong>, and the sampling length as
<strong>10 seconds</strong>. This means we assume that each camera
sampled its area for 10 seconds each hour.</p>
<p>With this information in hand, we can now create our sampling
occasion dataframe, called “occ”.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>study_dates <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="fu">c</span>(<span class="st">&quot;2022-11-08 00:00:00&quot;</span>, <span class="st">&quot;2023-02-19 00:00:00&quot;</span>), <span class="at">tz =</span> <span class="st">&quot;UTC&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>occ <span class="ot">&lt;-</span> <span class="fu">build_occ</span>(<span class="at">samp_freq =</span> <span class="dv">3600</span>, <span class="co"># seconds between the start of each sampling occasion</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>                 <span class="at">samp_length =</span> <span class="dv">10</span>, <span class="co"># duration of each sampling occasion</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                 <span class="at">study_start =</span> study_dates[<span class="dv">1</span>],</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>                 <span class="at">study_end =</span> study_dates[<span class="dv">2</span>])</span></code></pre></div>
<table>
<caption>occ</caption>
<thead>
<tr class="header">
<th align="right">occ</th>
<th align="left">start</th>
<th align="left">end</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">2022-11-08 00:00:00</td>
<td align="left">2022-11-08 00:00:10</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">2022-11-08 01:00:00</td>
<td align="left">2022-11-08 01:00:10</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">2022-11-08 02:00:00</td>
<td align="left">2022-11-08 02:00:10</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">2022-11-08 03:00:00</td>
<td align="left">2022-11-08 03:00:10</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">2022-11-08 04:00:00</td>
<td align="left">2022-11-08 04:00:10</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">2022-11-08 05:00:00</td>
<td align="left">2022-11-08 05:00:10</td>
</tr>
</tbody>
</table>
</div>
<div id="step-6-build-your-encounter-history" class="section level2">
<h2>Step 6: Build your encounter history</h2>
<p>Now we’re finally ready to build our STE encounter history! This is
the final data object that we will use to run our model.</p>
<p>We can build our encounter history with one simple step using the
ste_eh function in the spaceNtime package. This function creates an
encounter history with an NA on every occasion where no animals were
detected. The model will treat these NAs as right-censors.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>ste_eh <span class="ot">&lt;-</span> <span class="fu">ste_build_eh</span>(df, deploy, occ)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt; data checks: 0.016 sec elapsed</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt; effort: 0.155 sec elapsed</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; calculate censors: 0.005 sec elapsed</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; calculate STE: 0.262 sec elapsed</span></span></code></pre></div>
<table>
<caption>STE encounter history</caption>
<thead>
<tr class="header">
<th align="right">occ</th>
<th align="left">start</th>
<th align="left">end</th>
<th align="right">STE</th>
<th align="right">censor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">2022-11-08 00:00:00</td>
<td align="left">2022-11-08 00:00:10</td>
<td align="right">NA</td>
<td align="right">61.6</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">2022-11-08 01:00:00</td>
<td align="left">2022-11-08 01:00:10</td>
<td align="right">NA</td>
<td align="right">61.6</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">2022-11-08 02:00:00</td>
<td align="left">2022-11-08 02:00:10</td>
<td align="right">NA</td>
<td align="right">61.6</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">2022-11-08 03:00:00</td>
<td align="left">2022-11-08 03:00:10</td>
<td align="right">NA</td>
<td align="right">61.6</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">2022-11-08 04:00:00</td>
<td align="left">2022-11-08 04:00:10</td>
<td align="right">NA</td>
<td align="right">61.6</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">2022-11-08 05:00:00</td>
<td align="left">2022-11-08 05:00:10</td>
<td align="right">NA</td>
<td align="right">61.6</td>
</tr>
</tbody>
</table>
<p>The encounter history has one row for every sampling occasion and
contains the following columns:</p>
<p>-<strong>occ</strong>: the number of the sampling occasion from our
“deploy” object. (class: integer)</p>
<p>-<strong>start</strong>: the timstamp of the start of the sampling
occasion. (class: POSIXct)</p>
<p>-<strong>end</strong>: the timstamp of the end of the sampling
occasion. (class: POSIXct)</p>
<p>-<strong>STE</strong>: the total area required for sampling before
the first detection of the target species during the sampling occasion.
The units will match those used for the area column in the “deploy” data
frame. If the target species was not detected, this is NA. (class:
numeric)</p>
<p>-<strong>censor</strong>: The sum of all cameras’ viewable areas on
each sampling occasion. ste_build_eh() interprets a lack of photos on a
sampling occasion as species absence if the sampling effort data.frame
has a record for that camera/sampling occasion combination and it
defines the camera area as greater than 0. If there is no record for
that camera/sampling occasion in the sampling effort data.frame,
ste_build_eh() will add 0 area to the censor value and ignore that
camera when calculating STE.</p>
</div>
<div id="step-7-estimate-abundance" class="section level2">
<h2>Step 7: Estimate abundance!</h2>
<p>Now that we’ve done the hard work of wrangling our data into an
encounter history, we can estimate the STE abundance using one simple
line of code! All we need is the ste_estN_fn from the spaceNtime
package. We only need to give the function 2 components:</p>
<ol style="list-style-type: decimal">
<li>our encounter history</li>
<li>the total area of our study (i.e. the area we want to estimate
abundance for)</li>
</ol>
<p>Be sure to specify your study_area size in the same units as your
camera visible areas!</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">ste_estN_fn</span>(ste_eh, <span class="at">study_area =</span> <span class="dv">1</span> <span class="sc">*</span> <span class="fl">1e6</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt;          N       SE      LCI      UCI</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt; 1 3.260299 1.456672 1.412892 7.523253</span></span></code></pre></div>
<p>So we estimate that there are about 3.2 boar per km2 in our study
area with a 95% confidence interval of 1.4 to 7.3.</p>
<p><strong>Note</strong>: Due to the randomness inherent in building the
STE encounter history, estimates of abundance vary slightly when the
model is run multiple times.</p>
</div>
<div id="version-2-timelapse-data" class="section level2">
<h2>Version 2: Timelapse Data</h2>
<p>Now we will repeat the analysis with an augmented version of the
dataset where we pretend that photos were taken at regular time lapse
intervals and we assume that none of the timelapse photos contained boar
except for our original detections.</p>
</div>
<div id="step-1-import-the-timelapse-data" class="section level2">
<h2>Step 1: Import the timelapse data</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co">#classified timelapse photos</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>tl_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;boar_timelapse_example_data_SLP.csv&quot;</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span></code></pre></div>
<p>Let’s examine the example data to see what we’re working with:</p>
<table>
<caption>Example Data (Timelapse</caption>
<thead>
<tr class="header">
<th align="left">station</th>
<th align="left">species</th>
<th align="left">date_time</th>
<th align="right">area_m2</th>
<th align="right">group</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AZ38_a</td>
<td align="left">Boar_Wild</td>
<td align="left">2022-11-28 00:00:00</td>
<td align="right">15.4</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">AZ38_a</td>
<td align="left">Boar_Wild</td>
<td align="left">2022-11-28 01:00:00</td>
<td align="right">15.4</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">AZ38_a</td>
<td align="left">Boar_Wild</td>
<td align="left">2022-11-28 02:00:00</td>
<td align="right">15.4</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">AZ38_a</td>
<td align="left">Boar_Wild</td>
<td align="left">2022-11-28 03:00:00</td>
<td align="right">15.4</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">AZ38_a</td>
<td align="left">Boar_Wild</td>
<td align="left">2022-11-28 04:00:00</td>
<td align="right">15.4</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">AZ38_a</td>
<td align="left">Boar_Wild</td>
<td align="left">2022-11-28 05:00:00</td>
<td align="right">15.4</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div id="step-2-create-the-photo-information-data-frame" class="section level2">
<h2>Step 2: Create the photo information data frame</h2>
<p>Again, for the “df” object, we only need columns for the camera
station, time stamp, and the count of target animals, and they need to
be named “cam”, “datetime”, and “count” respectively. Let’s create that
object now by subsetting the required columns from our example data and
renaming them:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>df_tl <span class="ot">&lt;-</span> tl_data <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="fu">select</span>(station, date_time, group) <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">cam =</span> station,</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>         <span class="at">datetime =</span> date_time,</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>         <span class="at">count =</span> group)</span></code></pre></div>
<table>
<caption>df (Timelapse</caption>
<thead>
<tr class="header">
<th align="left">cam</th>
<th align="left">datetime</th>
<th align="right">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AZ38_a</td>
<td align="left">2022-11-28 00:00:00</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">AZ38_a</td>
<td align="left">2022-11-28 01:00:00</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">AZ38_a</td>
<td align="left">2022-11-28 02:00:00</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">AZ38_a</td>
<td align="left">2022-11-28 03:00:00</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">AZ38_a</td>
<td align="left">2022-11-28 04:00:00</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">AZ38_a</td>
<td align="left">2022-11-28 05:00:00</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div id="step-3-create-the-deployment-data-frame" class="section level2">
<h2>Step 3: Create the deployment data frame</h2>
<p>Now we need to create our “deploy” object in the Timelapse Format.
Recall that we need a row for each photo and columns for the camera
station, start time, end time, and the area visible to the camera. Areas
of 0 indicate cameras that were inactive or malfunctioning at that time
step. They need to be named “cam”, “start”, “end”, and “area”
respectively. We actually already have these columns in our timelapse
data frame, so simply subset and rename the necessary columns:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>deploy_tl <span class="ot">&lt;-</span> tl_data <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">select</span>(station, date_time, area_m2) <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">cam =</span> station,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>         <span class="at">start =</span> date_time,</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>         <span class="at">area =</span> area_m2) <span class="sc">%&gt;%</span> </span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">end =</span> start, <span class="at">.after =</span> start) <span class="co">#this line creates a time column for the end timestamp that is identical to the start timestamp</span></span></code></pre></div>
<table>
<caption>deploy (Timelapse</caption>
<thead>
<tr class="header">
<th align="left">cam</th>
<th align="left">start</th>
<th align="left">end</th>
<th align="right">area</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AZ38_a</td>
<td align="left">2022-11-28 00:00:00</td>
<td align="left">2022-11-28 00:00:00</td>
<td align="right">15.4</td>
</tr>
<tr class="even">
<td align="left">AZ38_a</td>
<td align="left">2022-11-28 01:00:00</td>
<td align="left">2022-11-28 01:00:00</td>
<td align="right">15.4</td>
</tr>
<tr class="odd">
<td align="left">AZ38_a</td>
<td align="left">2022-11-28 02:00:00</td>
<td align="left">2022-11-28 02:00:00</td>
<td align="right">15.4</td>
</tr>
<tr class="even">
<td align="left">AZ38_a</td>
<td align="left">2022-11-28 03:00:00</td>
<td align="left">2022-11-28 03:00:00</td>
<td align="right">15.4</td>
</tr>
<tr class="odd">
<td align="left">AZ38_a</td>
<td align="left">2022-11-28 04:00:00</td>
<td align="left">2022-11-28 04:00:00</td>
<td align="right">15.4</td>
</tr>
<tr class="even">
<td align="left">AZ38_a</td>
<td align="left">2022-11-28 05:00:00</td>
<td align="left">2022-11-28 05:00:00</td>
<td align="right">15.4</td>
</tr>
</tbody>
</table>
<p>Note that you can use the “Motion Sensor Format” of the deploy frame
here as well, and it should give you the same result. The “Timelapse
Format” is recommended because any missing photos are interpreted as
camera malfunctions rather than counts of 0, and you have more
flexibility to specify camera area and functionality.</p>
</div>
<div id="step-4-specify-the-sampling-occasions" class="section level2">
<h2>Step 4: Specify the sampling occasions</h2>
<p>Next we need to define our sampling occasions. We can follow exactly
the same steps here as we did for the motion-sensor version.</p>
<p>Again, we’ll define the sampling frequency as <strong>3600 seconds (1
hour)</strong>, and the sampling length as <strong>10 seconds</strong>.
This means we assume that each camera sampled its area for 10 seconds
each hour.</p>
<p>With this information in hand, we can now create our sampling
occasion dataframe.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>study_dates <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="fu">c</span>(<span class="st">&quot;2022-11-08 00:00:00&quot;</span>, <span class="st">&quot;2023-02-19 00:00:00&quot;</span>), <span class="at">tz =</span> <span class="st">&quot;UTC&quot;</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>occ_tl <span class="ot">&lt;-</span> <span class="fu">build_occ</span>(<span class="at">samp_freq =</span> <span class="dv">3600</span>, <span class="co"># seconds between the start of each sampling occasion</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>                 <span class="at">samp_length =</span> <span class="dv">10</span>, <span class="co"># duration of each sampling occasion</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>                 <span class="at">study_start =</span> study_dates[<span class="dv">1</span>],</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>                 <span class="at">study_end =</span> study_dates[<span class="dv">2</span>])</span></code></pre></div>
<table>
<caption>occ (Timelapse</caption>
<thead>
<tr class="header">
<th align="right">occ</th>
<th align="left">start</th>
<th align="left">end</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">2022-11-08 00:00:00</td>
<td align="left">2022-11-08 00:00:10</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">2022-11-08 01:00:00</td>
<td align="left">2022-11-08 01:00:10</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">2022-11-08 02:00:00</td>
<td align="left">2022-11-08 02:00:10</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">2022-11-08 03:00:00</td>
<td align="left">2022-11-08 03:00:10</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">2022-11-08 04:00:00</td>
<td align="left">2022-11-08 04:00:10</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">2022-11-08 05:00:00</td>
<td align="left">2022-11-08 05:00:10</td>
</tr>
</tbody>
</table>
</div>
<div id="step-5-build-your-encounter-history" class="section level2">
<h2>Step 5: Build your encounter history</h2>
<p>Again, this step is the same as the motion-sensor version. We just
use our new timelapse objects instead. Notice that building the
encounter history takes much longer now, because we have a lot more
data. The resulting encounter history looks very similar to the
motion-sensor version though.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>ste_eh_tl <span class="ot">&lt;-</span> <span class="fu">ste_build_eh</span>(df_tl, deploy_tl, occ_tl)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#&gt; data checks: 6.279 sec elapsed</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#&gt; effort: 13.477 sec elapsed</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co">#&gt; calculate censors: 0.005 sec elapsed</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt; calculate STE: 0.258 sec elapsed</span></span></code></pre></div>
<table>
<caption>STE encounter history (Timelapse)</caption>
<thead>
<tr class="header">
<th align="right">occ</th>
<th align="left">start</th>
<th align="left">end</th>
<th align="right">STE</th>
<th align="right">censor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">2022-11-08 00:00:00</td>
<td align="left">2022-11-08 00:00:10</td>
<td align="right">NA</td>
<td align="right">46.2</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">2022-11-08 01:00:00</td>
<td align="left">2022-11-08 01:00:10</td>
<td align="right">NA</td>
<td align="right">46.2</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">2022-11-08 02:00:00</td>
<td align="left">2022-11-08 02:00:10</td>
<td align="right">NA</td>
<td align="right">61.6</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">2022-11-08 03:00:00</td>
<td align="left">2022-11-08 03:00:10</td>
<td align="right">NA</td>
<td align="right">61.6</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">2022-11-08 04:00:00</td>
<td align="left">2022-11-08 04:00:10</td>
<td align="right">NA</td>
<td align="right">46.2</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">2022-11-08 05:00:00</td>
<td align="left">2022-11-08 05:00:10</td>
<td align="right">NA</td>
<td align="right">46.2</td>
</tr>
</tbody>
</table>
</div>
<div id="step-6-estimate-abundance" class="section level2">
<h2>Step 6: Estimate abundance!</h2>
<p>Our final step is also the same as before. All we need is the
ste_estN_fn from the spaceNtime package. Again, be sure to specify your
study_area size in the same units as your camera visible areas!</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">ste_estN_fn</span>(ste_eh_tl, <span class="at">study_area =</span> <span class="dv">1</span> <span class="sc">*</span> <span class="fl">1e6</span>)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co">#&gt;          N       SE      LCI      UCI</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">#&gt; 1 311.1922 17.06952 279.4942 346.4851</span></span></code></pre></div>
<p><strong>Note</strong>: Due to the randomness inherent in building the
STE encounter history, estimates of abundance vary slightly when the
model is run multiple times.</p>
<div id="more-help" class="section level3">
<h3>More help</h3>
<p>If you want more information about the spaceNtime package, you can
run the following chunk:</p>
<p>For help files and vignettes:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>??spaceNtime</span></code></pre></div>
<p><br />
The GitHub page for the R package is here: <a href="https://github.com/annam21/spaceNtime" class="uri">https://github.com/annam21/spaceNtime</a></p>
<p><br />
</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
